<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultra Advanced Match Streams</title>
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #111;
    color: #fff;
    display: flex;
    flex-direction: column;
    height: 100vh;
  }
  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(90deg, #1a1a1a, #222);
    padding: 10px 20px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.5);
  }
  .tabs {
    display: flex;
    gap: 10px;
  }
  .tab {
    padding: 8px 16px;
    background: #222;
    border-radius: 5px;
    cursor: pointer;
    transition: background 0.3s;
  }
  .tab.active {
    background: #ff4500;
    font-weight: bold;
  }
  select {
    padding: 5px;
    font-size: 16px;
    margin-left: 10px;
  }
  #timer {
    font-size: 18px;
    font-weight: bold;
  }
  #warning {
    background: #b00;
    padding: 5px 10px;
    margin-top: 5px;
    text-align: center;
    display: none;
    font-weight: bold;
  }
  #player-container {
    flex: 1;
    width: 100%;
    height: calc(100% - 70px);
    position: relative;
  }
  iframe {
    width: 100%;
    height: 100%;
    border: none;
  }
</style>
</head>
<body>

<header>
  <div class="tabs" id="match-tabs"></div>
  <div>
    Stream:
    <select id="stream-select"></select>
    <span id="timer">00:00</span>
  </div>
</header>

<div id="warning">⚠️ First stream may experience issues!</div>
<div id="player-container">
  <iframe id="player-frame" src="" allowfullscreen allow="encrypted-media; picture-in-picture;"></iframe>
</div>

<script>
const matches = [
  {
    name: "Wolves VS Man City",
    streams: [
      "https://embedsports.top/embed/echo/wolves-vs-manchester-city-football-1378975/1",
      "https://embedsports.top/embed/echo/wolves-vs-manchester-city-football-1378975/2",
      "https://embedsports.top/embed/alpha/wolverhampton-wanderers-vs-manchester-city/1",
      "https://embedsports.top/embed/alpha/wolverhampton-wanderers-vs-manchester-city/2",
      "https://embedsports.top/embed/alpha/wolverhampton-wanderers-vs-manchester-city/3",
      "https://embedsports.top/embed/alpha/wolverhampton-wanderers-vs-manchester-city/4",
     "https://embedsports.top/embed/alpha/wolverhampton-wanderers-vs-manchester-city/5",
     "https://embedsports.top/embed/alpha/wolverhampton-wanderers-vs-manchester-city/6",
     "https://embedsports.top/embed/alpha/wolverhampton-wanderers-vs-manchester-city/7"
    ],
    startTime: "2025-08-16T17:30:00"
  },
  {
    name: "Como VS Sudtirol",
    streams: [
      "https://embedsports.top/embed/echo/como-vs-sudtirol-football-1393803/1",
      "https://embedsports.top/embed/echo/como-vs-sudtirol-football-1393803/2",
      "https://embedsports.top/embed/echo/como-vs-sudtirol-football-1393803/3"
    ],
    startTime: "2025-08-16T17:30:00"
  },
  {
    name: "Rangers VS Alloa Athletic",
    streams: [
      "https://embedsports.top/embed/echo/rangers-vs-alloa-athletic-football-1421767/1",
      "https://embedsports.top/embed/alpha/rangers-vs-alloa-athletic/1",
      "https://embedsports.top/embed/alpha/rangers-vs-alloa-athletic/2",
      "https://embedsports.top/embed/alpha/rangers-vs-alloa-athletic/3"
    ],
    startTime: "2025-08-16T17:45:00"
  }
];

const playerFrame = document.getElementById("player-frame");
const streamSelect = document.getElementById("stream-select");
const warning = document.getElementById("warning");
const timerEl = document.getElementById("timer");
const tabsContainer = document.getElementById("match-tabs");

let currentMatchIndex = 0;
let timerInterval;

// -------------------- FUNCTIONS --------------------
// Create match tabs
function createTabs() {
  tabsContainer.innerHTML = "";
  matches.forEach((match, index) => {
    const tab = document.createElement("div");
    tab.classList.add("tab");
    if (index === currentMatchIndex) tab.classList.add("active");
    tab.textContent = match.title;
    tab.onclick = () => switchMatch(index);
    tabsContainer.appendChild(tab);
  });
}

// Switch match
function switchMatch(index) {
  currentMatchIndex = index;
  document.querySelectorAll('.tab').forEach((t, i) => {
    t.classList.toggle('active', i === index);
  });
  populateStreams();
  loadStream(matches[index].streams[0], true);
  startMatchTimer(new Date(matches[index].startTime));
}

// Populate streams dropdown
function populateStreams() {
  const match = matches[currentMatchIndex];
  streamSelect.innerHTML = "";
  match.streams.forEach((url, idx) => {
    const option = document.createElement("option");
    option.value = url;
    option.text = `Stream ${idx + 1}`;
    streamSelect.appendChild(option);
  });
}

// Load selected stream
function loadStream(url, firstStream = false) {
  playerFrame.src = url;
  warning.style.display = firstStream ? "block" : "none";
  setTimeout(() => {
    // Fallback check
    if (!playerFrame.contentWindow?.document) switchToNextStream();
  }, 10000);
}

// Switch to next stream
function switchToNextStream() {
  const match = matches[currentMatchIndex];
  let currentIndex = match.streams.indexOf(playerFrame.src);
  let nextIndex = (currentIndex + 1) % match.streams.length;
  loadStream(match.streams[nextIndex], nextIndex === 0);
  streamSelect.value = match.streams[nextIndex];
}

// Stream dropdown listener
streamSelect.addEventListener("change", () => {
  loadStream(streamSelect.value, streamSelect.selectedIndex === 0);
});

// -------------------- MATCH TIMER --------------------
function startMatchTimer(startTime) {
  clearInterval(timerInterval);
  function updateTimer() {
    const now = new Date();
    let elapsed = Math.floor((now - startTime) / 1000);
    let phase = "", minutes = 0, seconds = 0;

    if (elapsed < 2700) { // 0-45 + 5 added
      phase = "1st Half";
      minutes = Math.min(Math.floor(elapsed / 60), 50);
      seconds = elapsed % 60;
    } else if (elapsed < 3600) { // 15 min break
      phase = "Half-time";
      minutes = Math.floor((elapsed - 2700)/60);
      seconds = (elapsed - 2700)%60;
    } else if (elapsed < 6300) { // 45-90 + 5 added
      phase = "2nd Half";
      let secondHalfElapsed = elapsed - 3600;
      minutes = 45 + Math.min(Math.floor(secondHalfElapsed/60), 50);
      seconds = secondHalfElapsed % 60;
    } else {
      phase = "Full-time";
      minutes = 90;
      seconds = 0;
      clearInterval(timerInterval);
    }
    timerEl.textContent = `${phase}: ${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
  }
  updateTimer();
  timerInterval = setInterval(updateTimer, 1000);
}

// -------------------- INIT --------------------
createTabs();
populateStreams();
loadStream(matches[0].streams[0], true);
startMatchTimer(new Date(matches[0].startTime));
</script>

</body>
</html>
