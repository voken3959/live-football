<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free Football Streams</title>
<style>
  body {
    margin: 0;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    background: #0a0a0a;
    color: #e0e0e0;
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
  }

  header {
    padding: 15px 30px;
    background: linear-gradient(180deg, #1a1a1a, #121212);
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  }

  header h1 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 600;
    color: #ff8c00;
  }

  .nav-tabs {
    display: flex;
    gap: 15px;
  }

  .nav-tab {
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    background: #2a2a2a;
    transition: all 0.3s ease;
    font-weight: 500;
    font-size: 0.95rem;
  }

  .nav-tab:hover {
    background: #3a3a3a;
    transform: translateY(-1px);
  }

  .nav-tab.active {
    background: #ff8c00;
    color: #fff;
  }

  #statusBar {
    padding: 10px 30px;
    background: #151515;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.9rem;
    border-bottom: 1px solid #252525;
  }

  #statusBar .warning {
    color: #ffcc00;
    font-weight: 500;
  }

  #statusBar .status-loading { color: #00ccff; }
  #statusBar .status-active { color: #00ff00; }
  #statusBar .status-frozen { color: #ff4444; }
  #statusBar .status-not-playing { color: #ffcc00; }

  #timer {
    font-weight: 600;
    font-size: 1rem;
    color: #e0e0e0;
  }

  .page {
    display: none;
    flex: 1;
    overflow-y: auto;
    padding: 20px 30px;
    animation: fadeIn 0.3s ease;
  }

  .page.active {
    display: flex;
    flex-direction: column;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .schedule-grid {
    display: grid;
    gap: 15px;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  }

  .schedule-item {
    background: #1f1f1f;
    padding: 20px;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 1px solid #2a2a2a;
  }

  .schedule-item:hover {
    background: #2a2a2a;
    transform: translateY(-3px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }

  .schedule-item h3 {
    margin: 0 0 10px;
    font-size: 1.2rem;
    color: #ff8c00;
  }

  .schedule-item p {
    margin: 0;
    font-size: 0.9rem;
    color: #b0b0b0;
  }

  .stream-list {
    display: grid;
    gap: 8px;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    flex: 1;
    margin-top: 15px;
  }

  .stream-item {
    padding: 6px 8px;
    background: #1f1f1f;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 1px solid #2a2a2a;
    text-align: center;
    font-weight: 500;
    font-size: 0.85rem;
    line-height: 1.2;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .stream-item:hover {
    background: #2a2a2a;
    transform: translateY(-2px);
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
  }

  #playerContainer {
    flex: 1;
    position: relative;
    width: 100%;
  }

  iframe {
    width: 100%;
    height: 100%;
    border: none;
    border-radius: 10px;
  }

  #adminPanel {
    position: fixed;
    bottom: 0;
    width: 100%;
    background: #1a1a1a;
    padding: 10px;
    display: none;
    flex-direction: column;
    gap: 10px;
    border-top: 1px solid #2a2a2a;
    box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.3);
  }

  #adminPanel.active {
    display: flex;
  }

  #adminPassword {
    padding: 5px;
    font-size: 0.9rem;
    border: 1px solid #2a2a2a;
    background: #0a0a0a;
    color: #e0e0e0;
    border-radius: 4px;
  }

  .admin-form {
    display: flex;
    gap: 10px;
  }

  .admin-input {
    padding: 5px;
    font-size: 0.9rem;
    border: 1px solid #2a2a2a;
    background: #0a0a0a;
    color: #e0e0e0;
    border-radius: 4px;
    flex: 1;
  }

  .admin-select {
    padding: 5px;
    font-size: 0.9rem;
    border: 1px solid #2a2a2a;
    background: #0a0a0a;
    color: #e0e0e0;
    border-radius: 4px;
  }

  .admin-button {
    padding: 5px 10px;
    font-size: 0.9rem;
    background: #ff8c00;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    color: #fff;
    transition: background 0.3s ease;
  }

  .admin-button:hover {
    background: #e07b00;
  }
</style>
</head>
<body>

<header>
  <h1>Football Live</h1>
  <div class="nav-tabs" id="navTabs">
    <div class="nav-tab active" data-page="schedule">Schedule</div>
    <div class="nav-tab" data-page="streams">Streams</div>
    <div class="nav-tab" data-page="match">Match</div>
  </div>
</header>

<div id="statusBar">
  <div class="warning" id="streamStatus">⚠️ Stream may experience interruptions</div>
  <div id="timer">Match Timer: 00:00</div>
</div>

<div id="schedule" class="page active">
  <div class="schedule-grid" id="scheduleGrid"></div>
</div>

<div id="streams" class="page">
  <h2 id="streamMatchTitle" style="font-size: 1.8rem; font-weight: 600; color: #ff8c00;"></h2>
  <div class="stream-list" id="streamList"></div>
</div>

<div id="match" class="page">
  <div id="playerContainer">
    <iframe id="playerFrame" src="" allowfullscreen allow="encrypted-media; picture-in-picture;"></iframe>
  </div>
</div>

<div id="adminPanel">
  <input type="password" id="adminPassword" placeholder="Enter password">
  <div class="admin-form">
    <input type="text" id="adminTitle" class="admin-input" placeholder="Game Title">
    <input type="text" id="adminStreams" class="admin-input" placeholder="Stream Links (comma-separated)">
    <button class="admin-button" onclick="addGame()">Add Game</button>
  </div>
  <div class="admin-form">
    <select id="adminRemove" class="admin-select">
      <option value="">Select Game to Remove</option>
    </select>
    <button class="admin-button" onclick="removeGame()">Remove Game</button>
  </div>
</div>

<script>
const matches = [
  {
    name: "Wolves VS Man City",
    streams: [
      "https://embedsports.top/embed/echo/wolves-vs-manchester-city-football-1378975/1",
      "https://embedsports.top/embed/echo/wolves-vs-manchester-city-football-1378975/2",
      "https://embedsports.top/embed/alpha/wolverhampton-wanderers-vs-manchester-city/1"
    ],
    startTime: new Date("2025-08-16T17:30:00")
  },
  {
    name: "Monaco VS Le Havre AC",
    streams: [
      "https://embedsports.top/embed/echo/as-monaco-vs-le-havre-ac/1",
      "https://embedsports.top/embed/alpha/as-monaco-vs-le-havre-ac/1"
    ],
    startTime: new Date("2025-08-16T18:00:00")
  },
  {
    name: "Rangers VS Alloa Athletic",
    streams: [
      "https://embedsports.top/embed/echo/rangers-vs-alloa-athletic-football-1421767/1",
      "https://embedsports.top/embed/alpha/rangers-vs-alloa-athletic/1"
    ],
    startTime: new Date("2025-08-16T17:45:00")
  },
  {
    name: "Mallorca VS Barcelona",
    streams: [
      "https://embedsports.top/embed/alpha/mallorca-vs-barcelona/1",
      "https://embedsports.top/embed/alpha/mallorca-vs-barcelona/2"
    ],
    startTime: new Date("2025-08-16T18:30:00")
  },
  {
    name: "Stuttgart vs Bayern Munich",
    streams: [
      "https://embedsports.top/embed/alpha/germany-super-cup-vfb-stuttgart-vs-bayern-munich/1",
      "https://embedsports.top/embed/alpha/stuttgart-vs-bayern-munich/2"
    ],
    startTime: new Date("2025-08-17T12:00:00")
  },
  {
    name: "Inter Milan vs Olympiacos",
    streams: [
      "https://embedsports.top/embed/alpha/inter-milan-vs-olympiacos/1",
      "https://embedsports.top/embed/alpha/inter-milan-vs-olympiacos/2"
    ],
    startTime: new Date("2025-08-17T14:00:00")
  }
];

// Sort matches by start time
matches.sort((a, b) => a.startTime - b.startTime);

let currentMatchIndex = 0;
let currentStreamIndex = 0;
let currentPage = 'schedule';
let timerInterval = null;
let streamLoadTimeout = null;
let streamCheckInterval = null;
let isStreamPlaying = false;

const navTabs = document.getElementById('navTabs');
const scheduleGrid = document.getElementById('scheduleGrid');
const streamMatchTitle = document.getElementById('streamMatchTitle');
const streamList = document.getElementById('streamList');
const playerFrame = document.getElementById('playerFrame');
const streamStatus = document.getElementById('streamStatus');
const timerEl = document.getElementById('timer');
const adminPanel = document.getElementById('adminPanel');
const adminPassword = document.getElementById('adminPassword');
const adminTitle = document.getElementById('adminTitle');
const adminStreams = document.getElementById('adminStreams');
const adminRemove = document.getElementById('adminRemove');

// Page navigation
navTabs.querySelectorAll('.nav-tab').forEach(tab => {
  tab.addEventListener('click', () => {
    currentPage = tab.dataset.page;
    updatePage();
  });
});

function updatePage() {
  document.querySelectorAll('.page').forEach(page => {
    page.classList.toggle('active', page.id === currentPage);
  });
  document.querySelectorAll('.nav-tab').forEach(tab => {
    tab.classList.toggle('active', tab.dataset.page === currentPage);
  });

  if (currentPage === 'schedule') {
    renderSchedule();
    if (timerInterval) clearInterval(timerInterval);
    if (streamCheckInterval) clearInterval(streamCheckInterval);
    if (streamLoadTimeout) clearTimeout(streamLoadTimeout);
    streamStatus.textContent = '⚠️ Stream may experience interruptions';
    streamStatus.className = 'warning';
    isStreamPlaying = false;
  } else if (currentPage === 'streams') {
    renderStreams();
    if (timerInterval) clearInterval(timerInterval);
    if (streamCheckInterval) clearInterval(streamCheckInterval);
    if (streamLoadTimeout) clearTimeout(streamLoadTimeout);
    streamStatus.textContent = '⚠️ Stream may experience interruptions';
    streamStatus.className = 'warning';
    isStreamPlaying = false;
  } else if (currentPage === 'match') {
    loadStream();
    startMatchTimer();
    startStreamCheck();
  }
}

// Render schedule page, hiding matches that ended over 4 hours ago
function renderSchedule() {
  scheduleGrid.innerHTML = '';
  const now = new Date();
  const fourHoursInMs = 4 * 60 * 60 * 1000; // 4 hours in milliseconds

  matches.forEach((match, index) => {
    const matchEndTime = new Date(match.startTime.getTime() + 110 * 60 * 1000); // Assuming match ends after 110 minutes
    if (now - matchEndTime <= fourHoursInMs) { // Show match if it hasn't been over 4 hours since end
      const item = document.createElement('div');
      item.className = 'schedule-item';
      item.innerHTML = `
        <h3>${match.name}</h3>
        <p>Start: ${match.startTime.toLocaleString('en-US', {
          weekday: 'short',
          month: 'short',
          day: 'numeric',
          hour: 'numeric',
          minute: '2-digit',
          hour12: true
        })}</p>
      `;
      item.onclick = () => {
        currentMatchIndex = index;
        currentStreamIndex = 0; // Reset stream index when selecting a new match
        currentPage = 'streams';
        updatePage();
      };
      scheduleGrid.appendChild(item);
    }
  });
  updateRemoveDropdown();
}

// Render streams page
function renderStreams() {
  streamMatchTitle.textContent = matches[currentMatchIndex].name;
  streamList.innerHTML = '';
  matches[currentMatchIndex].streams.forEach((stream, index) => {
    const item = document.createElement('div');
    item.className = 'stream-item';
    item.textContent = `Stream ${index + 1}`;
    item.onclick = () => {
      currentStreamIndex = index;
      currentPage = 'match';
      updatePage();
    };
    streamList.appendChild(item);
  });
}

// Load stream and monitor load status
function loadStream() {
  const match = matches[currentMatchIndex];
  if (currentStreamIndex >= match.streams.length) {
    streamStatus.textContent = 'No more streams available';
    streamStatus.className = 'status-frozen';
    return;
  }

  playerFrame.src = match.streams[currentStreamIndex];
  streamStatus.textContent = 'Loading stream...';
  streamStatus.className = 'status-loading';
  isStreamPlaying = false;

  // Set timeout to check if stream loads within 5 seconds
  if (streamLoadTimeout) clearTimeout(streamLoadTimeout);
  streamLoadTimeout = setTimeout(() => {
    if (!isStreamPlaying) {
      streamStatus.textContent = 'Stream failed to load, trying another link';
      streamStatus.className = 'status-frozen';
      currentStreamIndex = (currentStreamIndex + 1) % match.streams.length; // Cycle to next stream
      loadStream(); // Try next stream
    }
  }, 5000);

  playerFrame.onload = () => {
    // Simulate audio detection (cross-origin prevents actual audio check)
    isStreamPlaying = true;
    streamStatus.textContent = 'Stream active';
    streamStatus.className = 'status-active';
    if (streamLoadTimeout) clearTimeout(streamLoadTimeout);
  };

  playerFrame.onerror = () => {
    isStreamPlaying = false;
    streamStatus.textContent = 'Stream failed to load, trying another link';
    streamStatus.className = 'status-frozen';
    currentStreamIndex = (currentStreamIndex + 1) % match.streams.length; // Cycle to next stream
    loadStream(); // Try next stream
  };
}

// Check for stream playback status
function startStreamCheck() {
  if (streamCheckInterval) clearInterval(streamCheckInterval);

  streamCheckInterval = setInterval(() => {
    if (currentPage !== 'match') return;

    // Simulate checking if stream is playing (since we can't access iframe audio)
    if (isStreamPlaying) {
      streamStatus.textContent = 'Stream active';
      streamStatus.className = 'status-active';
    } else {
      streamStatus.textContent = 'Stream not playing';
      streamStatus.className = 'status-not-playing';
    }
  }, 2000);
}

// MATCH TIMER LOGIC
function startMatchTimer() {
  if (timerInterval) clearInterval(timerInterval);

  const match = matches[currentMatchIndex];
  const startTime = new Date(match.startTime);
  const now = new Date();

  timerInterval = setInterval(() => {
    const currentTime = new Date();
    let elapsed = Math.floor((currentTime - startTime) / 1000); // seconds

    let displayText = "";
    if (elapsed < 0) {
      displayText = `Match Starts In: ${formatTime(Math.abs(elapsed))}`;
    } else if (elapsed < 45 * 60) {
      displayText = `Match Timer: ${formatTime(elapsed)} (1st Half)`;
    } else if (elapsed < 50 * 60) {
      displayText = `Match Timer: ${formatTime(elapsed - 45 * 60)} (1st Half Added Time)`;
    } else if (elapsed < 60 * 60) {
      displayText = `Halftime: ${formatTime(elapsed - 50 * 60)}`;
    } else if (elapsed < 105 * 60) {
      displayText = `Match Timer: ${formatTime(elapsed - 60 * 60 + 45 * 60)} (2nd Half)`;
    } else if (elapsed < 110 * 60) {
      displayText = `Match Timer: ${formatTime(elapsed - 105 * 60)} (2nd Half Added Time)`;
    } else {
      displayText = "Full Time";
      clearInterval(timerInterval);
    }

    timerEl.textContent = displayText;
  }, 1000);
}

function formatTime(seconds) {
  const m = Math.floor(seconds / 60);
  const s = seconds % 60;
  return `${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
}

// Admin Panel Functions
adminPassword.addEventListener('keypress', (e) => {
  if (e.key === 'Enter' && adminPassword.value === 'admin123') {
    adminPanel.classList.add('active');
    adminPassword.style.display = 'none';
    updateRemoveDropdown();
  }
});

function addGame() {
  const title = adminTitle.value.trim();
  const streamsInput = adminStreams.value.trim();
  if (title && streamsInput) {
    const streams = streamsInput.split(',').map(s => s.trim()).filter(s => s);
    matches.push({
      name: title,
      streams: streams,
      startTime: new Date()
    });
    adminTitle.value = '';
    adminStreams.value = '';
    renderSchedule();
  }
}

function removeGame() {
  const selectedIndex = adminRemove.value;
  if (selectedIndex) {
    matches.splice(selectedIndex, 1);
    updateRemoveDropdown();
    renderSchedule();
  }
}

function updateRemoveDropdown() {
  adminRemove.innerHTML = '<option value="">Select Game to Remove</option>';
  matches.forEach((match, index) => {
    const option = document.createElement('option');
    option.value = index;
    option.textContent = match.name;
    adminRemove.appendChild(option);
  });
}

// Initialize
updatePage();
</script>

</body>
</html>
